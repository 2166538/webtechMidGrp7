<html>

<head>
  <meta property="og:url" content="http://www.nytimes.com/2015/02/19/arts/international/when-great-minds-dont-think-alike.html" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="When Great Minds Donâ€™t Think Alike" />
  <meta property="og:description" content="How much does culture influence creative thinking?" />
  <meta property="og:image" content="http://static01.nyt.com/images/2015/02/19/arts/international/19iht-btnumbers19A/19iht-btnumbers19A-facebookJumbo-v2.jpg" />
  <link rel="stylesheet" href="css/materialize.min.css">
</head>

<body>
  <p><a href="index.html">Back to home</a></p>
  <center>
    <h1><a href="index.html">Food Recipe</a></h1>
  </center>

  <div id="fb-root"></div>
  <script>
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s);
      js.id = id;
      js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.2';
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
  </script>
  <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


  <div class="row" id="contents">

  </div>

  <script src="js/jquery-3.3.1.min.js"></script>
  <script src="js/materialize.min.js"></script>
  <script>
    $(document).ready(function() {
      var query = window.location.search
      query = query.substring(1, query.length)
      var queries = query.split('&')
      console.log(queries)

      $.ajax({
        type: 'GET',
        url: https://api.edamam.com/search?q=${queries[0].split('=')[1]}&app_id=eb3fc1c2&app_key=c0069ef329ad42af0ab77954821de835,
        success: function(data) {
          console.log(data);
          var contentsData = ''
          $.each(data.hits, function(i, c) {
            if (i == parseInt(queries[1].split('=')[1])) {
              contentsData +=
                `<div class="z-depth-1">
                  <center>
                    <div class="col s12">
                      <div class="card-image">
                        <img src="${c.recipe.image}">
                        <div class="card-content black-text">
                          <h5 class="card-title">${c.recipe.label}</h3>
                          <span class="card-title">${c.recipe.yield} servings</span>
                          <p>Ingredients:</p>
                          ${showIngredients(c.recipe.ingredients)}
                          <h6>Calories: ${c.recipe.calories} kcal</h6>
                          <h6>Total Weight: ${c.recipe.totalWeight} g</h6> 
                          <h6>Source: ${c.recipe.source}</h6>
                        </div>
                      </div>
                    </div>
                  </center>
                </div>`

              $('#contents').html(contentsData)
            }
          })
        },
        error: function(err) {
          console.log(err)
        }
      })

      $.ajaxSetup({
        cache: true
      });
      $.getScript('https://connect.facebook.net/en_US/sdk.js', function() {
        FB.init({
          appId: 'eb3fc1c2&app_key=c0069ef329ad42af0ab77954821de835',
          version: 'v2.7' // or v2.1, v2.2, v2.3, ...
        });
        $('#loginbutton,#feedbutton').removeAttr('disabled');
        FB.getLoginStatus(function() {
          alert('Error!')
        });
      });
    });

    function showIngredients(ingredients) {
      var ings = ""
      $.each(ingredients, function(i, g) {
        ings += <div class="card-title">${g.text}</div>
      })
      return ings
    }
    $(document).ready(function() {
      $('.modal').modal();
    });
  </script>
  
  <center>
    <a class="waves-effect waves-light btn modal-trigger" href="#modal1">Modal</a>
    <!-- Modal Structure -->
    <div id="modal1" class="modal">
      <div class="modal-content">
        <h4>Nutrient Analysis</h4>
        <p>A bunch of text</p>
      </div>
      <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
      </div>
    </div>
    <h4>Share on:</h4>
    <a href="https://twitter.com/share?url=${c.recipe.url}" class="twitter-share-button" data-show-count="false">Tweet</a>
    <div class="fb-share-button" data-href="${c.recipe.url}" data-layout="button_count" data-size="small" data-mobile-iframe="true"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=${c.recipe.url}&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">Share</a></div>
  </center>

</body>

</html>
